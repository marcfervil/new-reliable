<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Cat Coding</title>
        <style>
            img {
                -webkit-user-drag: none;
                -khtml-user-drag: none;
                -moz-user-drag: none;
                -o-user-drag: none;
                user-drag: none;
            }
        </style>
    </head>
    <body>
        <img id="image" style="position:absolute;" src="https://media.giphy.com/media/JIX9t2j0ZTN9S/giphy.gif" width="300" />
        <button onclick="yuh()">yuh</button>
    </body>
</html>

<script type="text/javascript">
    let img = document.getElementById('image');

    let vscode = undefined;
   
    let isVsCode = !(typeof acquireVsCodeApi === 'undefined');
    if(isVsCode) vscode = acquireVsCodeApi();


    function makeDraggable(element, liveshare){
        element.mouseDown = 0;
        element.offset = {x: 0, y:0}
        element.onmousedown = function(e) { 
            element.offset.x = e.layerX;
            element.offset.y = e.layerY;
            element.mouseDown = 1;
        }
        element.onmouseup = function() {
            element.mouseDown = 0;
        }
        element.onmousemove = function(e){
            if(element.mouseDown==1){
                img.style.left = (e.clientX-element.offset.x)+"px";
                img.style.top = (e.clientY-element.offset.y)+"px";
            }
        }
        if(liveshare){
            vscode.postMessage({
                command: "Drag",
                id: element.id,
                pos: {x: img.style.left, y: img.style.top}
            });
        }
    }


    makeDraggable(img, isVsCode);

    if(isVsCode){
        window.addEventListener('message', event => {
            const message = event.data; 
            if(message.command == "Drag"){
                let element = document.getElementById(message.id);
                element.style.left = message.pos.x;
                element.style.top = message.pos.y;
            }
        });
    }

    var div = document.createElement("div"); 
    div.innerHTML = isVsCode;
    document.body.appendChild(div);
</script>